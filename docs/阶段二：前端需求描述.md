# 阶段二：前端需求描述文档

> **文档版本**: v2.0
> **创建日期**: 2025-12-16
> **最后更新**: 2025-12-16
> **适用范围**: 团队任务追踪系统前端开发
> **技术栈**: Vue3 + TypeScript + Element Plus + Pinia + WebSocket

---

## 📋 目录

- [1. 产品概述](#1-产品概述)
- [2. 业务场景分析](#2-业务场景分析)
- [3. 功能模块架构](#3-功能模块架构)
- [4. 详细功能需求](#4-详细功能需求)
- [5. 界面设计规范](#5-界面设计规范)
- [6. 实时同步机制](#6-实时同步机制)
- [7. 交互设计规范](#7-交互设计规范)
- [8. 数据统计功能](#8-数据统计功能)
- [9. 响应式设计](#9-响应式设计)
- [10. 技术实现规范](#10-技术实现规范)
- [11. 验收标准](#11-验收标准)
- [12. UI变更日志](#12-ui变更日志)

---

## 1. 产品概述

### 1.1 产品目标
构建一个实时同步的团队任务管理前端系统，支持多组协作、任务追踪、数据统计等功能。

### 1.2 核心价值
- **实时性**: 秒级同步团队任务进展
- **易用性**: 极简操作流程，快速上手
- **可视化**: 直观展示团队进展和任务状态
- **灵活性**: 支持跨组权限管理，灵活配置

### 1.3 目标用户
- **团队成员**: 记录和更新个人任务进展
- **组长**: 管理组内任务，跟踪团队进展
- **管理员**: 跨组管理，查看全局数据统计

---

## 2. 业务场景分析

### 2.1 核心业务场景
**场景**: 团队每日任务管理及进展同步系统

#### 关键特征
- 团队成员每日记录和更新Top任务
- 按组别组织管理
- 实时同步进展状态
- 统一预览和概览

#### 任务周期支持
- ✅ **每日任务追踪**: 支持每日Top任务快速记录和更新
- ✅ **跨多天任务**: 支持长期任务的分阶段进展追踪
- ✅ **历史记录**: 支持查看历史任务数据和进展记录

#### 组别管理特性
- ✅ **动态创建**: 支持动态创建和删除组
- ✅ **组员管理**: 支持添加和删除组员
- ✅ **跨组权限**: 一个用户可同时属于多个组，权限相互隔离
- ✅ **管理员权限**: 管理员可查看和管理所有组

### 2.2 任务细节要求

#### 任务字段规范
```typescript
interface Task {
  id: string                    // 任务ID
  title: string                 // 任务标题
  description: string           // 任务描述
  module: string               // 模块归属
  priority: 'urgent' | 'high' | 'medium' | 'low'  // 优先级
  status: 'todo' | 'in_progress' | 'in_review' | 'done' | 'blocked'  // 任务状态
  assignee: User               // 责任人
  reporter: User               // 创建者
  group: Group                 // 所属组
  dueDate: Date               // 截止时间
  progress: number            // 进展百分比（0-100）
  progressDescription: string // 进展描述
  createdAt: Date
  updatedAt: Date
  completedAt?: Date
}
```

#### 权限控制规则

| 操作类型 | 组员权限 | 组长权限 | 管理员权限 |
|---------|---------|---------|-----------|
| 查看任务 | ✓ 本组任务 | ✓ 本组所有任务 | ✓ 所有任务 |
| 创建任务 | ✓ | ✓ | ✓ |
| 更新进展 | ✓ 自己的任务 | ✓ 本组所有任务 | ✓ 所有任务 |
| 修改任务描述 | ✗ | ✓ | ✓ |
| 修改截止时间 | ✗ | ✓ | ✓ |
| 修改责任人 | ✗ | ✓ | ✓ |
| 修改优先级 | ✗ | ✓ | ✓ |
| 删除任务 | ✗ | ✓（仅本组） | ✓ |
| 审批任务 | ✗ | ✓ | ✓ |

### 2.3 统计维度要求

#### 团队维度统计
- 各组任务数量统计
- 各组闭环率计算（已完成/总任务）
- 任务状态分布分析
- 团队进展趋势分析

#### 个人维度统计
- 个人任务完成率
- 个人贡献排行
- 个人进展更新频率
- 个人任务趋势分析

#### 任务维度统计
- 任务优先级分布
- 任务模块分布
- 任务完成时间分析
- 阻塞任务统计

### 2.4 实时性要求
- **秒级同步**: 任务状态变更秒级同步到所有客户端
- **WebSocket连接**: 支持WebSocket长连接
- **断线重连**: 自动重连机制
- **离线提示**: 离线状态明确提示

---

## 3. 功能模块架构

### 3.1 核心模块清单

```
团队任务追踪系统
├── 用户认证模块
│   ├── 登录/登出
│   ├── 权限管理
│   └── 个人设置
├── 我的任务模块
│   ├── 今日Top任务
│   ├── 我的所有任务
│   ├── 历史任务记录
│   └── 进展更新
├── 团队管理模块
│   ├── 我的组
│   ├── 全部组概览
│   ├── 组员管理
│   └── 跨组协作
├── 任务详情模块
│   ├── 任务编辑（组长权限）
│   ├── 进展更新（组员权限）
│   ├── 任务历史
│   └── 评论互动
└── 数据统计模块
    ├── 团队进度仪表板
    ├── 个人贡献统计
    ├── 任务状态分析
    └── 闭环率报表
```

### 3.2 页面路由设计

| 路径 | 页面名称 | 权限要求 | 功能描述 |
|------|---------|---------|---------|
| `/` | 仪表板 | 登录用户 | 全局概览和快速导航 |
| `/my-tasks` | 我的任务 | 登录用户 | 个人任务管理 |
| `/teams` | 团队概览 | 登录用户 | 所有组概览 |
| `/teams/:id` | 组详情 | 组内成员 | 组内任务详情 |
| `/statistics` | 数据统计 | 组长+ | 统计报表 |
| `/settings` | 设置 | 登录用户 | 个人和组设置 |

---

## 4. 详细功能需求

### 4.1 用户认证模块

#### 4.1.1 登录功能
- **支持方式**: 邮箱+密码登录
- **记住登录**: 支持7天免登录
- **权限验证**: 登录后获取用户权限和组权限
- **登录失败提示**: 友好错误提示

#### 4.1.2 权限管理
- **角色识别**: 自动识别用户角色（组员/组长/管理员）
- **组权限**: 记录用户所属的所有组
- **权限控制**: 前端路由守卫，后端权限验证
- **权限缓存**: 本地缓存权限信息

#### 4.1.3 个人设置
- **个人信息**: 头像、姓名、邮箱修改
- **通知设置**: 消息提醒开关
- **界面设置**: 主题、字号、语言设置
- **密码修改**: 定期提醒修改密码

### 4.2 我的任务模块

#### 4.2.1 今日Top任务
- **任务列表**: 显示优先级最高的10个任务
- **状态指示**: 清晰的颜色编码和图标
- **进展显示**: 进度条 + 进展描述
- **时间戳**: 显示最后更新时间
- **快速操作**:
  - 双击编辑任务
  - 拖拽更新状态
  - 快捷键操作

#### 4.2.2 任务操作功能

**创建任务**
- **触发方式**:
  - 顶部"新建任务"按钮
  - 快捷键 `Ctrl/Cmd + N`
  - 右键菜单
- **表单字段**:
  - 标题（必填）
  - 描述（可选）
  - 模块（下拉选择）
  - 优先级（必填）
  - 截止时间（可选）
  - 责任人（默认当前用户，可修改）
- **验证规则**:
  - 标题长度：1-200字符
  - 截止时间不能早于当前时间
  - 责任人必须在同一组

**更新进展**
- **进展百分比**: 滑块或输入框（0-100）
- **进展描述**: 文本框，支持多行
- **自动保存**: 输入后2秒自动保存
- **进展历史**: 记录所有进展更新历史

**编辑任务（组长权限）**
- **可编辑字段**: 标题、描述、模块、优先级、截止时间、责任人
- **编辑方式**:
  - 列表中直接编辑
  - 详情面板编辑
  - 批量编辑
- **权限检查**: 只能编辑本组任务

#### 4.2.3 任务筛选和排序

**筛选条件**
- **状态**: 多选，可筛选多个状态
- **优先级**: 单选或多选
- **模块**: 下拉多选
- **截止时间**: 今天、本周、本月、自定义范围
- **责任人**: 当前用户、组内全部

**排序方式**
- **优先级**: 高→低 或 低→高
- **截止时间**: 最早→最晚 或 最晚→最早
- **更新时间**: 最新→最旧 或 最旧→最新
- **创建时间**: 最新→最旧 或 最旧→最新
- **进展**: 高→低 或 低→高

#### 4.2.4 历史任务记录
- **时间范围**: 支持按日期范围筛选
- **任务状态**: 全部、已完成、已取消
- **数据导出**: 支持导出Excel格式
- **搜索功能**: 支持关键词搜索

### 4.3 团队管理模块

#### 4.3.1 全部组概览
- **组卡片展示**:
  - 组名和图标
  - 成员数量
  - 任务总数
  - 完成数/总数
  - 整体进度
  - 今日进展
- **状态指示**:
  - 🟢 正常：进度正常
  - 🟡 警告：进度滞后
  - 🔴 异常：大量阻塞任务
- **快速操作**:
  - 点击卡片进入组详情
  - 悬停显示组统计信息

#### 4.3.2 组详情页面

**组信息栏**
```
┌─────────────────────────────────────────┐
│ 🔵 前端组                               │
│ 👥 8人  📋 23任务  ✅ 12完成  📊 52%进展  │
└─────────────────────────────────────────┘
```

**成员任务表格**
- **表格列**:
  - 成员头像和姓名
  - 今日Top任务（最多3个）
  - 整体进展
  - 在线状态
  - 最后活跃时间
- **交互功能**:
  - 点击成员行展开查看全部任务
  - 快速更新他人任务进展（组长权限）
  - 查看成员历史数据

**组员管理（组长权限）**
- **添加组员**:
  - 搜索用户
  - 邀请加入
  - 设置角色
- **移除组员**:
  - 确认弹窗
  - 任务重新分配
- **角色管理**:
  - 设置副组长
  - 权限分配

#### 4.3.3 跨组协作
- **任务共享**: 可将任务共享给其他组
- **跨组查看**: 管理员可查看所有组
- **数据隔离**: 组间数据相互隔离
- **协作记录**: 记录跨组协作历史

### 4.4 任务详情模块

#### 4.4.1 任务详情面板
- **基础信息**:
  - 任务标题（可编辑）
  - 模块标签
  - 优先级（颜色标识）
  - 任务状态（状态流转图）
  - 截止时间（倒计时显示）
- **人员信息**:
  - 责任人
  - 创建者
  - 最后更新者
- **时间信息**:
  - 创建时间
  - 更新时间
  - 完成时间（如已完成）
- **进展信息**:
  - 当前进展百分比
  - 进展描述历史
  - 进展更新时间线

#### 4.4.2 任务操作记录
- **操作历史**: 记录所有操作历史
- **进展时间线**: 可视化进展变化
- **评论系统**: 支持添加评论（可选）
- **文件附件**: 支持上传附件（可选）

### 4.5 数据统计模块

#### 4.5.1 仪表板设计

**顶部概览卡片**
```
┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐
│  总任务  │ │  已完成  │ │  进行中  │ │  闭环率  │
│   68    │ │   36    │ │   28    │ │   92%   │
└──────────┘ └──────────┘ └──────────┘ └──────────┘
```

**图表区域**
- **各组任务分布**（饼图）
  - 按组统计任务数量
  - 鼠标悬停显示详细数据
  - 点击切片筛选数据

- **任务状态分析**（柱状图）
  - 按状态统计任务数
  - 支持时间范围筛选
  - 可切换维度（按组、按模块）

- **闭环率趋势**（折线图）
  - 展示每日/周/月闭环率
  - 支持对比不同组
  - 显示目标线（90%）

- **成员贡献排行**（排行榜）
  - 按任务完成数排序
  - 按贡献积分排序
  - 显示头像和完成率

#### 4.5.2 报表功能
- **日报**: 每日任务进展总结
- **周报**: 周度团队进展分析
- **月报**: 月度绩效统计
- **自定义报表**:
  - 时间范围选择
  - 统计维度选择
  - 数据导出（Excel/PDF）

#### 4.5.3 数据筛选
- **时间范围**: 今天、本周、本月、自定义
- **组别筛选**: 单选或多选组
- **人员筛选**: 单选或多选人员
- **模块筛选**: 按模块筛选
- **优先级筛选**: 按优先级筛选

---

## 5. 界面设计规范

### 5.1 设计原则
- **简洁明了**: 界面简洁，避免过度装饰
- **一致性**: 统一的设计语言和交互模式
- **可访问性**: 支持键盘导航和屏幕阅读器
- **响应式**: 适配不同屏幕尺寸

### 5.2 色彩规范

#### 5.2.1 主色调
- **主色**: #409EFF (Element Plus 蓝)
- **成功色**: #67C23A (绿色)
- **警告色**: #E6A23C (橙色)
- **危险色**: #F56C6C (红色)
- **信息色**: #909399 (灰色)

#### 5.2.2 优先级颜色
- **紧急**: #F56C6C (红色)
- **高**: #E6A23C (橙色)
- **中**: #409EFF (蓝色)
- **低**: #67C23A (绿色)

#### 5.2.3 状态颜色
- **待办**: #909399 (灰色)
- **进行中**: #409EFF (蓝色)
- **待审核**: #E6A23C (橙色)
- **已完成**: #67C23A (绿色)
- **已阻塞**: #F56C6C (红色)

### 5.3 字体规范
- **中文字体**: "PingFang SC", "Microsoft YaHei", sans-serif
- **英文字体**: "Roboto", "Helvetica Neue", Arial, sans-serif
- **字号层级**:
  - 大标题: 24px
  - 中标题: 20px
  - 小标题: 16px
  - 正文: 14px
  - 辅助文字: 12px

### 5.4 间距规范
- **基础间距单位**: 4px
- **常用间距**:
  - 极小: 4px
  - 小: 8px
  - 中: 16px
  - 大: 24px
  - 特大: 32px

### 5.5 页面布局设计

#### 5.5.1 我的任务页面

```
┌─────────────────────────────────────────┐
│ 顶部工具栏                              │
│ [新建任务] [筛选▼] [排序▼] [视图▼] [搜索框] │
├─────────────────────────────────────────┤
│                                         │
│ ┌─────────────────┐ ┌─────────────────┐ │
│ │  任务列表        │ │   任务详情面板    │ │
│ │                 │ │                 │ │
│ │ 今日Top任务      │ │ ┌─────────────┐ │ │
│ │ ┌─────────────┐ │ │ │ 任务标题    │ │ │
│ │ │ 🔴 修复Bug  │ │ │ │ [可编辑]    │ │ │
│ │ │ 进展: 80%   │ │ │ └─────────────┘ │ │
│ │ │ 更新: 2h前  │ │ │                 │ │
│ │ └─────────────┘ │ │ 模块: [下拉]    │ │
│ │                 │ │ 优先级: [下拉]   │ │
│ │ ┌─────────────┐ │ │ 截止时间: [日期] │ │
│ │ │ 🟡 优化UI   │ │ │ 责任人: [用户]   │ │
│ │ │ 进展: 45%   │ │ │                 │ │
│ │ │ 更新: 1d前  │ │ │ ┌─────────────┐ │ │
│ │ └─────────────┘ │ │ │ ●●●○○○○○○○ │ │ │
│ │                 │ │ │ 75%         │ │ │
│ │ ...             │ │ └─────────────┘ │ │
│ └─────────────────┘ │                 │ │
│                     │ 进展描述:        │ │
│                     │ [文本框]         │ │
│                     │                 │ │
│                     │ [保存进展]       │ │
│                     └─────────────────┘ │
└─────────────────────────────────────────┘
```

#### 5.5.2 团队概览页面

```
┌─────────────────────────────────────────┐
│ 顶部筛选栏                              │
│ [全部组▼] [时间范围▼] [导出报表]           │
├─────────────────────────────────────────┤
│                                         │
│ 主体: 卡片式布局                         │
│ ┌─────────────┐ ┌─────────────┐         │
│ │ 🔵 前端组    │ │ 🔵 后端组    │         │
│ │             │ │             │         │
│ │ 👥 8人      │ │ 👥 6人      │         │
│ │ 📋 23任务   │ │ 📋 18任务   │         │
│ │ ✅ 完成12   │ │ ✅ 完成8    │         │
│ │             │ │             │         │
│ │ 进度: 52%   │ │ 进度: 44%   │         │
│ │ [查看详情]   │ │ [查看详情]   │         │
│ └─────────────┘ └─────────────┘         │
│                                         │
│ ┌─────────────┐ ┌─────────────┐         │
│ │ 🔵 测试组    │ │ 🔵 运维组    │         │
│ │             │ │             │         │
│ │ 👥 5人      │ │ 👥 4人      │         │
│ │ 📋 15任务   │ │ 📋 12任务   │         │
│ │ ✅ 完成9    │ │ ✅ 完成7    │         │
│ │             │ │             │         │
│ │ 进度: 60%   │ │ 进度: 58%   │         │
│ │ [查看详情]   │ │ [查看详情]   │         │
│ └─────────────┘ └─────────────┘         │
└─────────────────────────────────────────┘
```

#### 5.5.3 组详情页面

```
┌─────────────────────────────────────────┐
│ 组信息栏                                │
│ 🔵 前端组  |  👥 8人  |  📊 23任务/12完成  │
├─────────────────────────────────────────┤
│                                         │
│ 主体: 成员任务表格                       │
│ ┌─────────────────────────────────────┐ │
│ │ 成员    │ 今日Top任务 │ 进展  │ 状态  │ │
│ ├─────────────────────────────────────┤ │
│ │ 👤 张三  │ 🔴 修复Bug  │ 80%   │ 进行中│ │
│ │         │ 🟡 优化UI  │ 45%   │ 进行中│ │
│ ├─────────────────────────────────────┤ │
│ │ 👤 李四  │ 🟢 文档编写│ 100%  │ 已完成│ │
│ │         │ 🟡 接口测试│ 60%   │ 进行中│ │
│ └─────────────────────────────────────┘ │
│                                         │
│ [添加成员] [导出数据] [组设置]           │
└─────────────────────────────────────────┘
```

#### 5.5.4 数据统计仪表板

```
┌─────────────────────────────────────────┐
│ 统计概览                                │
│ ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐         │
│ │总任务│ │已完成│ │进行中│ │闭环率│         │
│ │ 68  │ │ 36  │ │ 28  │ │ 92% │         │
│ └─────┘ └─────┘ └─────┘ └─────┘         │
├─────────────────────────────────────────┤
│                                         │
│ ┌─────────────────┐ ┌─────────────────┐ │
│ │   各组任务分布   │ │   任务状态分析   │ │
│ │    [饼状图]     │ │    [柱状图]     │ │
│ └─────────────────┘ └─────────────────┘ │
│                                         │
│ ┌─────────────────┐ ┌─────────────────┐ │
│ │   闭环率趋势     │ │   成员贡献排行   │ │
│ │    [折线图]     │ │    [排行榜]     │ │
│ └─────────────────┘ └─────────────────┘ │
└─────────────────────────────────────────┘
```

### 5.6 组件设计规范

#### 5.6.1 通用组件
- **BaseButton**: 基础按钮组件
- **BaseTable**: 增强表格组件
- **BaseModal**: 通用弹窗组件
- **BaseForm**: 表单组件
- **BaseCard**: 卡片组件
- **ProgressBar**: 进度条组件
- **StatusTag**: 状态标签组件
- **PriorityTag**: 优先级标签组件

#### 5.6.2 业务组件
- **UserAvatar**: 用户头像
- **TaskCard**: 任务卡片
- **GroupCard**: 组卡片
- **StatisticsChart**: 统计图表
- **TaskFilter**: 任务筛选器
- **TaskEditor**: 任务编辑器
- **ProgressTimeline**: 进展时间线

---

## 6. 实时同步机制

### 6.1 WebSocket连接管理

#### 6.1.1 连接策略
- **建立时机**: 用户登录成功后立即建立连接
- **连接地址**: `ws://localhost:8000/ws/{user_id}`
- **认证方式**: 携带JWT Token进行认证
- **心跳机制**: 每30秒发送一次心跳包
- **断线检测**: 60秒未收到心跳视为断线

#### 6.1.2 重连机制
```javascript
// 重连策略
const RECONNECT_CONFIG = {
  maxReconnectAttempts: 5,
  reconnectInterval: 3000,  // 3秒
  reconnectIncrement: 2000  // 每次重连间隔增加2秒
}
```

#### 6.1.3 离线处理
- **离线提示**: 显示红色通知栏提示离线状态
- **数据缓存**: 本地缓存未同步的操作
- **自动重试**: 网络恢复后自动重试未成功的操作
- **冲突解决**: 服务器返回最新数据，覆盖本地缓存

### 6.2 消息协议设计

#### 6.2.1 消息格式
```typescript
interface WebSocketMessage {
  type: 'task_update' | 'task_create' | 'task_delete' | 'user_online' | 'user_offline'
  payload: any
  timestamp: number
  user_id: string
  group_id?: string
}
```

#### 6.2.2 消息类型

| 类型 | 描述 | payload结构 |
|------|-----|------------|
| task_update | 任务更新 | `{ task_id, field, old_value, new_value, user_id }` |
| task_create | 任务创建 | `{ task, user_id }` |
| task_delete | 任务删除 | `{ task_id, user_id }` |
| progress_update | 进展更新 | `{ task_id, progress, description, user_id }` |
| user_online | 用户上线 | `{ user_id }` |
| user_offline | 用户下线 | `{ user_id }` |

### 6.3 实时更新场景

#### 6.3.1 任务进展更新
- **触发条件**: 用户更新任务进展
- **广播范围**: 同组所有用户
- **UI反馈**:
  - 进度条动画效果
  - 时间戳更新
  - "张三刚刚更新了进展"提示

#### 6.3.2 任务状态变更
- **触发条件**: 拖拽或手动更新任务状态
- **广播范围**: 同组所有用户
- **UI反馈**:
  - 状态标签颜色变化
  - 状态流转动画
  - 列表自动排序

#### 6.3.3 新任务创建
- **触发条件**: 用户创建新任务
- **广播范围**: 同组所有用户
- **UI反馈**:
  - 新任务淡入动画
  - 任务数统计更新
  - 声音提示（可选）

#### 6.3.4 任务删除
- **触发条件**: 组长或管理员删除任务
- **广播范围**: 同组所有用户
- **UI反馈**:
  - 任务淡出动画
  - 确认删除提示
  - 撤销操作按钮

#### 6.3.5 用户在线状态
- **触发条件**: 用户登录/登出
- **广播范围**: 所有有交集的用户
- **UI反馈**:
  - 头像绿点状态
  - 在线人数统计
  - 最后活跃时间

### 6.4 数据一致性保障

#### 6.4.1 乐观更新
```javascript
// 更新流程
1. 用户操作 → 更新本地UI
2. 发送API请求
3. API成功 → 发送WebSocket广播
4. 其他客户端收到 → 更新UI
5. API失败 → 回滚UI并提示错误
```

#### 6.4.2 冲突解决
- **时间戳优先**: 以服务器时间戳为准
- **最后写入生效**: 后更新的覆盖先更新的
- **人工介入**: 重大冲突时提示用户手动解决

#### 6.4.3 数据校验
- **前端校验**: 表单验证、数据格式验证
- **后端校验**: 权限验证、业务规则验证
- **消息校验**: 消息格式、完整性校验

---

## 7. 交互设计规范

### 7.1 键盘快捷键

#### 7.1.1 全局快捷键
- `Ctrl/Cmd + /`: 聚焦搜索框
- `Ctrl/Cmd + N`: 新建任务
- `Ctrl/Cmd + S`: 保存当前编辑
- `T`: 切换到"我的任务"
- `G`: 切换到"团队概览"
- `D`: 切换到仪表板
- `?`: 显示快捷键帮助

#### 7.1.2 任务操作快捷键
- `1-5`: 快速设置优先级（1=紧急，5=低）
- `Ctrl/Cmd + ↑`: 任务上移
- `Ctrl/Cmd + ↓`: 任务下移
- `Delete`: 删除任务（需确认）
- `Enter`: 编辑任务
- `Space`: 快速更新进展

#### 7.1.3 筛选和搜索
- `Ctrl/Cmd + F`: 聚焦搜索框
- `Esc`: 清除搜索
- `Alt + F`: 打开筛选器

### 7.2 鼠标交互

#### 7.2.1 拖拽操作
- **任务状态更新**:
  - 拖拽任务到不同状态列
  - 释放时触发状态变更
  - 显示可放置区域高亮
- **任务排序**:
  - 拖拽调整任务优先级
  - 实时预览排序结果
  - 释放时保存排序
- **跨组分配**（组长权限）:
  - 拖拽任务到其他组员
  - 显示分配确认提示
  - 释放时更新责任人

#### 7.2.2 右键菜单
- **任务列表右键**:
  - 编辑任务
  - 更新进展
  - 复制任务
  - 删除任务
  - 添加子任务
- **组卡片右键**:
  - 查看详情
  - 组设置
  - 导出数据

#### 7.2.3 双击操作
- **任务标题**: 直接编辑任务
- **进展**: 快速更新进展
- **优先级**: 循环切换优先级
- **状态**: 循环切换状态

### 7.3 触控手势（移动端）

#### 7.3.1 手势操作
- **左滑**: 快速更新进展（显示进展滑块）
- **右滑**: 返回上级页面
- **双击**: 编辑任务
- **长按**: 显示操作菜单
- **捏合**: 缩放图表
- **上滑**: 加载更多任务

#### 7.3.2 移动端优化
- **大按钮**: 最小点击区域44px
- **手势反馈**: 视觉和触觉反馈
- **防误触**: 重要操作需确认
- **操作提示**: 手势操作引导提示

### 7.4 加载状态设计

#### 7.4.1 加载动画
- **页面加载**: 骨架屏 + 进度条
- **数据加载**: 表格骨架 + 加载图标
- **操作加载**: 按钮loading状态
- **实时同步**: 同步动画效果

#### 7.4.2 空状态设计
- **无任务**: 显示空状态插画 + 引导文案
- **无数据**: 显示"暂无数据" + 操作建议
- **搜索无结果**: 显示搜索建议

### 7.5 错误处理设计

#### 7.5.1 错误提示
- **Toast提示**: 非阻塞性错误，3秒自动消失
- **弹窗提示**: 阻塞性错误，需用户确认
- **行内错误**: 表单字段错误，红色提示
- **页面错误**: 错误页面 + 刷新按钮

#### 7.5.2 错误分级
- **P0（严重）**: 系统崩溃、数据丢失
  - 红色弹窗 + 声音警报
  - 立即通知管理员
- **P1（重要）**: 功能不可用
  - 橙色Toast + 重试按钮
  - 记录错误日志
- **P2（一般）**: 功能异常
  - 黄色提示
  - 静默记录
- **P3（轻微）**: 体验问题
  - 灰色提示
  - 可忽略

---

## 8. 数据统计功能

### 8.1 统计维度详细设计

#### 8.1.1 团队维度统计

**任务数量统计**
```
总任务数: 68
├── 按组分类:
│   ├── 前端组: 23 (34%)
│   ├── 后端组: 18 (26%)
│   ├── 测试组: 15 (22%)
│   └── 运维组: 12 (18%)
├── 按状态分类:
│   ├── 待办: 12 (18%)
│   ├── 进行中: 28 (41%)
│   ├── 待审核: 6 (9%)
│   ├── 已完成: 20 (29%)
│   └── 已阻塞: 2 (3%)
└── 按优先级分类:
    ├── 紧急: 8 (12%)
    ├── 高: 15 (22%)
    ├── 中: 32 (47%)
    └── 低: 13 (19%)
```

**闭环率计算**
```
闭环率 = (已完成任务数 / 总任务数) × 100%

当前整体闭环率: 92%

各组闭环率:
├── 前端组: 90% (21/23)
├── 后端组: 89% (16/18)
├── 测试组: 93% (14/15)
└── 运维组: 100% (12/12)
```

**任务趋势分析**
- **每日新增任务数**: 折线图展示
- **每日完成任务数**: 折线图展示
- **任务平均完成时间**: 计算公式
- **任务完成率趋势**: 月度/周度趋势

#### 8.1.2 个人维度统计

**个人任务完成率**
```
张三 - 前端组
├── 总任务: 15
├── 已完成: 12 (80%)
├── 进行中: 2 (13%)
├── 待办: 1 (7%)
└── 闭环率: 85%
```

**个人贡献排行**
```
贡献积分算法:
- 完成普通任务: +10分
- 完成高优先级任务: +15分
- 完成紧急任务: +20分
- 每日更新进展: +2分

排行榜:
1. 张三 - 185分
2. 李四 - 162分
3. 王五 - 158分
4. 赵六 - 145分
5. 孙七 - 132分
```

**个人进展更新频率**
- **统计周期**: 每日/每周/每月
- **更新次数**: 统计更新进展的次数
- **平均间隔**: 计算更新间隔的平均值
- **活跃时段**: 统计最活跃的时间段

#### 8.1.3 任务维度统计

**任务优先级分布**
```
饼图展示:
- 紧急 (8): 12%
- 高 (15): 22%
- 中 (32): 47%
- 低 (13): 19%
```

**任务模块分布**
```
横向柱状图展示:
- 前端模块: 23任务
- 后端模块: 18任务
- 数据库模块: 12任务
- 运维模块: 9任务
- 文档模块: 6任务
```

**任务完成时间分析**
- **平均完成时间**: 3.5天
- **最快完成**: 0.5天
- **最慢完成**: 15天
- **中位数**: 2.8天

**阻塞任务统计**
```
当前阻塞任务: 2
├── 前端组: 1
│   └── 等待后端API完成
└── 后端组: 1
    └── 等待测试环境就绪

阻塞原因分布:
- 依赖其他任务: 50%
- 等待资源: 30%
- 技术难题: 20%
```

### 8.2 图表设计规范

#### 8.2.1 图表类型选择

| 数据类型 | 推荐图表 | 说明 |
|---------|---------|------|
| 占比数据 | 饼图/环形图 | 展示各部分占比 |
| 趋势数据 | 折线图 | 展示时间趋势 |
| 对比数据 | 柱状图/条形图 | 横向/纵向对比 |
| 排行数据 | 排行榜/柱状图 | 排序展示 |
| 分布数据 | 散点图/热力图 | 数据分布 |
| 流程数据 | 甘特图/流程图 | 时间流程 |

#### 8.2.2 图表配色方案
- **主色调**: #409EFF
- **辅助色**:
  - #67C23A (绿色)
  - #E6A23C (橙色)
  - #F56C6C (红色)
  - #909399 (灰色)
- **渐变色**:
  - 蓝色渐变: #409EFF → #66B1FF
  - 绿色渐变: #67C23A → #85CE61

#### 8.2.3 图表交互设计
- **鼠标悬停**: 显示详细数据
- **点击钻取**: 点击图表深入查看
- **图例筛选**: 点击图例隐藏/显示数据
- **缩放平移**: 支持图表缩放和平移
- **导出图片**: 支持导出为PNG/SVG

### 8.3 报表功能设计

#### 8.3.1 报表类型

**日报模板**
```
【团队任务日报】- 2025-12-16

一、整体概况
- 总任务数: 68
- 今日新增: 5
- 今日完成: 8
- 闭环率: 92%

二、各组进展
前端组:
- 任务数: 23 | 完成: 12 | 进行中: 9 | 完成率: 52%
- 今日亮点: 完成登录模块优化
- 阻塞任务: 1个（等待后端API）

后端组:
- 任务数: 18 | 完成: 8 | 进行中: 8 | 完成率: 44%
- 今日亮点: 完成用户认证服务
- 阻塞任务: 1个（等待测试环境）

三、个人贡献Top3
1. 张三 - 完成3个任务
2. 李四 - 完成2个任务
3. 王五 - 完成2个任务

四、明日重点
- 前端组: 修复登录Bug
- 后端组: 完成API文档
```

**周报模板**
```
【团队任务周报】- 2025.12.10 ~ 2025.12.16

一、本周概况
- 新增任务: 32
- 完成任务: 28
- 闭环率: 88% (↑3%)
- 平均完成时间: 3.5天

二、组别对比
[各组任务对比柱状图]

三、任务趋势
[本周任务趋势折线图]

四、问题总结
- 阻塞任务: 2个
- 延期风险: 3个任务
- 技术难点: 1个

五、下周计划
- 目标闭环率: 90%
- 重点任务: 12个
```

#### 8.3.2 自定义报表
- **字段选择**: 选择要展示的字段
- **筛选条件**: 设置数据筛选条件
- **图表类型**: 选择图表展示方式
- **时间范围**: 设置统计时间范围
- **导出格式**: 支持Excel、PDF、图片格式

#### 8.3.3 定时报表
- **设置入口**: 管理后台设置定时报表
- **报表周期**: 每日/每周/每月
- **接收人员**: 设置接收报表的邮箱
- **报表内容**: 可选择报表模板

### 8.4 数据权限控制

#### 8.4.1 数据可见性
- **组员**: 只能查看本组数据
- **组长**: 可查看本组详细数据，可查看其他组汇总数据
- **管理员**: 可查看所有组详细数据

#### 8.4.2 数据脱敏
- **个人数据**: 其他人的进展描述可能脱敏
- **敏感信息**: 手机号、邮箱等敏感信息脱敏
- **统计汇总**: 个人数据仅在汇总时显示

---

## 9. 响应式设计

### 9.1 断点设计

#### 9.1.1 断点规范
```scss
$breakpoints: (
  xs: 0,        // 超小屏幕 (手机)
  sm: 576px,    // 小屏幕 (大屏手机)
  md: 768px,    // 中等屏幕 (平板)
  lg: 992px,    // 大屏幕 (小桌面)
  xl: 1200px,   // 超大屏幕 (桌面)
  xxl: 1600px   // 2K屏幕
);
```

#### 9.1.2 布局适配

| 断点 | 屏幕尺寸 | 布局特点 | 功能适配 |
|------|---------|---------|---------|
| **xs/sm** | < 768px | 单栏布局 | 简化操作，大按钮 |
| **md** | 768-991px | 两栏布局 | 侧边栏可折叠 |
| **lg** | 992-1199px | 两栏/三栏布局 | 完整功能 |
| **xl/xxl** | ≥1200px | 三栏布局 | 完整功能+额外信息 |

### 9.2 桌面端设计 (≥1200px)

#### 9.2.1 布局特点
- **三栏布局**: 左侧导航 + 中间主内容 + 右侧详情
- **宽屏优化**: 利用宽屏空间显示更多信息
- **多窗口支持**: 可同时打开多个任务详情
- **鼠标悬停**: 丰富的hover效果

#### 9.2.2 交互优化
- **右键菜单**: 支持右键快速操作
- **拖拽操作**: 完整的拖拽支持
- **键盘快捷键**: 完整的键盘操作支持
- **多选操作**: 支持Ctrl/Cmd多选

### 9.3 平板端设计 (768-1199px)

#### 9.3.1 布局调整
- **两栏布局**: 左侧导航 + 主内容
- **详情页适配**: 点击后在下方弹出详情
- **手势支持**: 支持滑动切换标签页
- **横竖屏适配**: 响应横屏和竖屏方向

#### 9.3.2 操作优化
- **触摸友好**: 增大点击区域
- **手势操作**: 左滑返回、右滑前进
- **底部工具栏**: 重要操作放在底部

### 9.4 移动端设计 (<768px)

#### 9.4.1 布局特点
- **单栏布局**: 全屏显示主要内容
- **底部导航**: Tab导航栏
- **顶部筛选**: 可折叠的筛选栏
- **下拉刷新**: 支持下拉刷新数据

#### 9.4.2 功能简化
- **核心功能**: 只保留最核心的功能
- **操作简化**: 减少复杂操作
- **信息精简**: 显示最关键信息
- **加载优化**: 分页加载，减少一次加载数据量

#### 9.4.3 页面适配示例

**我的任务页面（移动端）**
```
┌─────────────────────────┐
│ 顶部栏                  │
│ [≡]  我的任务    [+] [🔍]│
├─────────────────────────┤
│                         │
│ 今日Top任务 (3)          │
│ ┌─────────────────────┐ │
│ │ 🔴 修复登录Bug       │ │
│ │ 进展: 80%           │ │
│ │ 今天 14:30 更新      │ │
│ │ [查看详情]          │ │
│ └─────────────────────┘ │
│                         │
│ ┌─────────────────────┐ │
│ │ 🟡 优化UI界面       │ │
│ │ 进展: 45%           │ │
│ │ 昨天 16:20 更新      │ │
│ │ [查看详情]          │ │
│ └─────────────────────┘ │
│                         │
│ ┌─────────────────────┐ │
│ │ 🟢 编写文档         │ │
│ │ 进展: 100%          │ │
│ │ 12-15 完成          │ │
│ │ [查看详情]          │ │
│ └─────────────────────┘ │
│                         │
├─────────────────────────┤
│ 底部导航                │
│ [首页] [任务] [团队] [我的]│
└─────────────────────────┘
```

**任务详情页面（移动端）**
```
┌─────────────────────────┐
│ 顶部栏                  │
│ [<]  任务详情    [⋯]     │
├─────────────────────────┤
│                         │
│ 任务标题                │
│ 修复登录Bug              │
│                         │
│ 进展                    │
│ ●●●○○○○○○○ 75%         │
│ ┌─────────────────────┐ │
│ │ 今天进展: 完成了登录 │ │
│ │ 验证逻辑...         │ │
│ └─────────────────────┘ │
│                         │
│ 模块: 前端               │
│ 优先级: 🔴 紧急          │
│ 状态: 进行中             │
│ 截止: 2025-12-20        │
│ 责任人: 张三             │
│                         │
│ [更新进展] [完成任务]     │
│                         │
│ 历史进展:               │
│ • 12-16 75% 完成验证逻辑 │
│ • 12-15 60% 完成UI修改  │
│ • 12-14 30% 开始开发    │
│                         │
└─────────────────────────┘
```

### 9.5 响应式组件设计

#### 9.5.1 表格响应式
- **桌面端**: 完整表格显示
- **平板端**: 可横向滚动
- **移动端**: 卡片式布局

#### 9.5.2 图表响应式
- **自动缩放**: 根据容器大小自动缩放
- **简化显示**: 小屏幕下简化图表
- **交互优化**: 移动端支持手势操作

#### 9.5.3 导航响应式
- **桌面端**: 左侧导航栏
- **平板端**: 可折叠侧边栏
- **移动端**: 底部Tab导航

### 9.6 性能优化

#### 9.6.1 加载优化
- **按需加载**: 路由组件按需加载
- **图片懒加载**: 图片延迟加载
- **骨架屏**: 数据加载时显示骨架屏

#### 9.6.2 渲染优化
- **虚拟滚动**: 长列表使用虚拟滚动
- **防抖节流**: 搜索和滚动事件防抖节流
- **缓存策略**: 合理使用浏览器缓存

---

## 10. 技术实现规范

### 10.1 前端技术栈

#### 10.1.1 核心依赖
```json
{
  "framework": "Vue 3.4+",
  "language": "TypeScript 5.0+",
  "bundler": "Vite 5.0+",
  "ui_library": "Element Plus 2.4+",
  "state_management": "Pinia 2.0+",
  "router": "Vue Router 4.0+",
  "http_client": "Axios 1.6+",
  "websocket": "Native WebSocket",
  "chart_library": "ECharts 5.4+",
  "date_library": "Day.js 1.11+",
  "utils_library": "Lodash 4.17+"
}
```

#### 10.1.2 开发工具
```json
{
  "code_style": "ESLint + Prettier",
  "type_check": "TypeScript Compiler",
  "unit_test": "Vitest 1.0+",
  "e2e_test": "Cypress 13.0+",
  "component_test": "@vue/test-utils",
  "git_hook": "Husky + lint-staged"
}
```

### 10.2 项目结构设计

```
frontend/
├── public/                      # 静态资源
│   ├── index.html
│   └── favicon.ico
├── src/
│   ├── main.ts                  # 入口文件
│   ├── App.vue                  # 根组件
│   ├── router/                  # 路由配置
│   │   └── index.ts
│   ├── store/                   # Pinia状态管理
│   │   ├── index.ts
│   │   ├── user.ts
│   │   ├── tasks.ts
│   │   ├── groups.ts
│   │   └── websocket.ts
│   ├── api/                     # API接口
│   │   ├── client.ts            # HTTP客户端
│   │   ├── user.ts
│   │   ├── tasks.ts
│   │   ├── groups.ts
│   │   └── statistics.ts
│   ├── views/                   # 页面组件
│   │   ├── Dashboard.vue        # 仪表板
│   │   ├── MyTasks.vue          # 我的任务
│   │   ├── TeamOverview.vue     # 团队概览
│   │   ├── GroupDetail.vue      # 组详情
│   │   ├── Statistics.vue       # 数据统计
│   │   └── Settings.vue         # 设置
│   ├── components/              # 通用组件
│   │   ├── base/                # 基础组件
│   │   ├── business/            # 业务组件
│   │   └── charts/              # 图表组件
│   ├── composables/             # 组合式函数
│   │   ├── useTasks.ts
│   │   ├── useWebSocket.ts
│   │   └── useStatistics.ts
│   ├── types/                   # TypeScript类型
│   │   ├── user.ts
│   │   ├── task.ts
│   │   ├── group.ts
│   │   └── common.ts
│   ├── utils/                   # 工具函数
│   │   ├── date.ts
│   │   ├── format.ts
│   │   ├── validation.ts
│   │   └── websocket.ts
│   ├── styles/                  # 样式文件
│   │   ├── main.scss
│   │   ├── variables.scss
│   │   └── mixins.scss
│   └── assets/                  # 资源文件
│       ├── images/
│       └── icons/
├── tests/                       # 测试
│   ├── unit/                    # 单元测试
│   ├── e2e/                     # 端到端测试
│   └── setup.ts                 # 测试配置
├── index.html
├── package.json
├── vite.config.ts
├── tsconfig.json
├── .eslintrc.js
├── .prettierrc.js
└── Dockerfile
```

### 10.3 状态管理设计

#### 10.3.1 Store模块划分

```typescript
// stores/index.ts
export { useUserStore } from './user'
export { useTasksStore } from './tasks'
export { useGroupsStore } from './groups'
export { useWebSocketStore } from './websocket'
export { useStatisticsStore } from './statistics'

// stores/user.ts
interface UserState {
  currentUser: User | null
  permissions: Permission[]
  groups: Group[]
  loading: boolean
}

interface UserActions {
  login(credentials: LoginCredentials): Promise<void>
  logout(): Promise<void>
  fetchCurrentUser(): Promise<void>
  updateProfile(data: UserUpdate): Promise<void>
}

// stores/tasks.ts
interface TasksState {
  myTasks: Task[]
  tasksByGroup: Record<string, Task[]>
  selectedTask: Task | null
  filters: TaskFilters
  loading: boolean
}

interface TasksActions {
  fetchMyTasks(): Promise<void>
  createTask(data: TaskCreate): Promise<Task>
  updateTask(id: string, data: TaskUpdate): Promise<Task>
  updateProgress(id: string, progress: number, description: string): Promise<void>
  deleteTask(id: string): Promise<void>
}

// stores/groups.ts
interface GroupsState {
  groups: Group[]
  currentGroup: Group | null
  members: Record<string, User[]>
  loading: boolean
}

// stores/websocket.ts
interface WebSocketState {
  connected: boolean
  reconnectAttempts: number
  lastMessage: WebSocketMessage | null
}

interface WebSocketActions {
  connect(): void
  disconnect(): void
  send(message: WebSocketMessage): void
  subscribe(channel: string): void
}
```

#### 10.3.2 状态持久化

```typescript
// 使用Pinia插件实现持久化
import { createPinia } from 'pinia'
import piniaPluginPersistedstate from 'pinia-plugin-persistedstate'

const pinia = createPinia()
pinia.use(piniaPluginPersistedstate)

// 在store中配置持久化
export const useUserStore = defineStore('user', {
  persist: {
    key: 'user',
    paths: ['currentUser', 'permissions', 'groups']
  }
})
```

### 10.4 API设计规范

#### 10.4.1 HTTP客户端配置

```typescript
// api/client.ts
import axios, { AxiosInstance, AxiosError } from 'axios'

class ApiClient {
  private client: AxiosInstance

  constructor() {
    this.client = axios.create({
      baseURL: import.meta.env.VITE_API_BASE_URL || '/api/v1',
      timeout: 10000,
      headers: {
        'Content-Type': 'application/json'
      }
    })

    // 请求拦截器
    this.client.interceptors.request.use(
      (config) => {
        const token = localStorage.getItem('token')
        if (token) {
          config.headers.Authorization = `Bearer ${token}`
        }
        return config
      },
      (error) => Promise.reject(error)
    )

    // 响应拦截器
    this.client.interceptors.response.use(
      (response) => response.data,
      (error: AxiosError) => {
        if (error.response?.status === 401) {
          // 处理未认证
          localStorage.removeItem('token')
          window.location.href = '/login'
        }
        return Promise.reject(error)
      }
    )
  }

  async get<T>(url: string, params?: any): Promise<T> {
    return this.client.get(url, { params })
  }

  async post<T>(url: string, data?: any): Promise<T> {
    return this.client.post(url, data)
  }

  async put<T>(url: string, data?: any): Promise<T> {
    return this.client.put(url, data)
  }

  async patch<T>(url: string, data?: any): Promise<T> {
    return this.client.patch(url, data)
  }

  async delete<T>(url: string): Promise<T> {
    return this.client.delete(url)
  }
}

export const apiClient = new ApiClient()
```

#### 10.4.2 API接口定义

```typescript
// api/tasks.ts
export const tasksApi = {
  // 获取我的任务
  getMyTasks(params?: TaskListParams): Promise<TaskListResponse> {
    return apiClient.get('/tasks/my', params)
  },

  // 创建任务
  createTask(data: TaskCreateRequest): Promise<Task> {
    return apiClient.post('/tasks', data)
  },

  // 更新任务
  updateTask(id: string, data: TaskUpdateRequest): Promise<Task> {
    return apiClient.patch(`/tasks/${id}`, data)
  },

  // 更新进展
  updateProgress(id: string, data: ProgressUpdateRequest): Promise<Task> {
    return apiClient.patch(`/tasks/${id}/progress`, data)
  },

  // 删除任务
  deleteTask(id: string): Promise<void> {
    return apiClient.delete(`/tasks/${id}`)
  },

  // 获取任务详情
  getTask(id: string): Promise<Task> {
    return apiClient.get(`/tasks/${id}`)
  },

  // 获取组任务
  getGroupTasks(groupId: string, params?: TaskListParams): Promise<TaskListResponse> {
    return apiClient.get(`/groups/${groupId}/tasks`, params)
  }
}
```

### 10.5 WebSocket实现

#### 10.5.1 WebSocket客户端封装

```typescript
// utils/websocket.ts
class WebSocketClient {
  private ws: WebSocket | null = null
  private url: string
  private reconnectAttempts = 0
  private maxReconnectAttempts = 5
  private reconnectInterval = 3000
  private heartbeatInterval = 30000
  private heartbeatTimer: number | null = null
  private listeners: Map<string, Function[]> = new Map()

  constructor(url: string) {
    this.url = url
  }

  connect(token: string) {
    const wsUrl = `${this.url}?token=${token}`
    this.ws = new WebSocket(wsUrl)

    this.ws.onopen = () => {
      console.log('WebSocket connected')
      this.reconnectAttempts = 0
      this.startHeartbeat()
      this.emit('connected')
    }

    this.ws.onmessage = (event) => {
      try {
        const message = JSON.parse(event.data)
        this.handleMessage(message)
      } catch (error) {
        console.error('Failed to parse WebSocket message:', error)
      }
    }

    this.ws.onclose = () => {
      console.log('WebSocket disconnected')
      this.stopHeartbeat()
      this.emit('disconnected')
      this.reconnect()
    }

    this.ws.onerror = (error) => {
      console.error('WebSocket error:', error)
    }
  }

  disconnect() {
    if (this.ws) {
      this.ws.close()
      this.ws = null
    }
    this.stopHeartbeat()
  }

  send(data: any) {
    if (this.ws && this.ws.readyState === WebSocket.OPEN) {
      this.ws.send(JSON.stringify(data))
    } else {
      console.warn('WebSocket is not connected')
    }
  }

  on(event: string, callback: Function) {
    if (!this.listeners.has(event)) {
      this.listeners.set(event, [])
    }
    this.listeners.get(event)!.push(callback)
  }

  off(event: string, callback: Function) {
    const callbacks = this.listeners.get(event)
    if (callbacks) {
      const index = callbacks.indexOf(callback)
      if (index > -1) {
        callbacks.splice(index, 1)
      }
    }
  }

  private emit(event: string, data?: any) {
    const callbacks = this.listeners.get(event)
    if (callbacks) {
      callbacks.forEach(callback => callback(data))
    }
  }

  private handleMessage(message: WebSocketMessage) {
    this.emit('message', message)
    this.emit(message.type, message.payload)
  }

  private reconnect() {
    if (this.reconnectAttempts < this.maxReconnectAttempts) {
      this.reconnectAttempts++
      console.log(`Reconnecting... (${this.reconnectAttempts}/${this.maxReconnectAttempts})`)
      setTimeout(() => {
        const token = localStorage.getItem('token')
        if (token) {
          this.connect(token)
        }
      }, this.reconnectInterval * this.reconnectAttempts)
    } else {
      console.error('Max reconnection attempts reached')
      this.emit('failed')
    }
  }

  private startHeartbeat() {
    this.heartbeatTimer = window.setInterval(() => {
      this.send({ type: 'ping', timestamp: Date.now() })
    }, this.heartbeatInterval)
  }

  private stopHeartbeat() {
    if (this.heartbeatTimer) {
      clearInterval(this.heartbeatTimer)
      this.heartbeatTimer = null
    }
  }
}

export default WebSocketClient
```

#### 10.5.2 WebSocket Store

```typescript
// stores/websocket.ts
import { defineStore } from 'pinia'
import WebSocketClient from '@/utils/websocket'

interface WebSocketState {
  client: WebSocketClient | null
  connected: boolean
  reconnectAttempts: number
  lastMessage: WebSocketMessage | null
}

export const useWebSocketStore = defineStore('websocket', {
  state: (): WebSocketState => ({
    client: null,
    connected: false,
    reconnectAttempts: 0,
    lastMessage: null
  }),

  actions: {
    connect() {
      const token = localStorage.getItem('token')
      if (!token) {
        console.error('No token found')
        return
      }

      const wsUrl = import.meta.env.VITE_WS_URL || 'ws://localhost:8000/ws'
      this.client = new WebSocketClient(wsUrl)

      this.client.on('connected', () => {
        this.connected = true
        this.reconnectAttempts = 0
      })

      this.client.on('disconnected', () => {
        this.connected = false
      })

      this.client.on('task_update', (payload) => {
        // 处理任务更新
        const tasksStore = useTasksStore()
        tasksStore.updateTaskFromWebSocket(payload)
      })

      this.client.on('task_create', (payload) => {
        const tasksStore = useTasksStore()
        tasksStore.addTaskFromWebSocket(payload.task)
      })

      this.client.on('task_delete', (payload) => {
        const tasksStore = useTasksStore()
        tasksStore.removeTaskFromWebSocket(payload.task_id)
      })

      this.client.connect(token)
    },

    disconnect() {
      if (this.client) {
        this.client.disconnect()
        this.client = null
      }
    },

    send(message: WebSocketMessage) {
      this.client?.send(message)
    }
  }
})
```

### 10.6 性能优化策略

#### 10.6.1 路由懒加载

```typescript
// router/index.ts
import { createRouter, createWebHistory } from 'vue-router'

const router = createRouter({
  history: createWebHistory(),
  routes: [
    {
      path: '/',
      name: 'dashboard',
      component: () => import('@/views/Dashboard.vue')
    },
    {
      path: '/my-tasks',
      name: 'my-tasks',
      component: () => import('@/views/MyTasks.vue')
    },
    {
      path: '/teams',
      name: 'teams',
      component: () => import('@/views/TeamOverview.vue')
    },
    {
      path: '/teams/:id',
      name: 'group-detail',
      component: () => import('@/views/GroupDetail.vue')
    },
    {
      path: '/statistics',
      name: 'statistics',
      component: () => import('@/views/Statistics.vue')
    }
  ]
})

export default router
```

#### 10.6.2 组件懒加载

```vue
<script setup lang="ts">
import { defineAsyncComponent } from 'vue'

// 懒加载图表组件
const StatisticsChart = defineAsyncComponent(() => import('@/components/charts/StatisticsChart.vue'))

// 懒加载任务编辑器
const TaskEditor = defineAsyncComponent(() => import('@/components/business/TaskEditor.vue'))
</script>
```

#### 10.6.3 虚拟滚动

```vue
<template>
  <div class="task-list">
    <RecycleScroller
      :items="tasks"
      :item-size="80"
      key-field="id"
      class="scroller"
    >
      <template #default="{ item }">
        <TaskCard :task="item" />
      </template>
    </RecycleScroller>
  </div>
</template>

<script setup lang="ts">
import { RecycleScroller } from 'vue-virtual-scroller'
import 'vue-virtual-scroller/dist/vue-virtual-scroller.css'
</script>
```

#### 10.6.4 防抖节流

```typescript
// utils/debounce.ts
export function debounce<T extends (...args: any[]) => any>(
  func: T,
  wait: number
): (...args: Parameters<T>) => void {
  let timeout: number | null = null

  return function executedFunction(...args: Parameters<T>) {
    const later = () => {
      timeout = null
      func(...args)
    }

    if (timeout) {
      clearTimeout(timeout)
    }
    timeout = window.setTimeout(later, wait)
  }
}

// utils/throttle.ts
export function throttle<T extends (...args: any[]) => any>(
  func: T,
  limit: number
): (...args: Parameters<T>) => void {
  let inThrottle: boolean

  return function executedFunction(...args: Parameters<T>) {
    if (!inThrottle) {
      func.apply(this, args)
      inThrottle = true
      setTimeout(() => inThrottle = false, limit)
    }
  }
}
```

### 10.7 错误处理规范

#### 10.7.1 全局错误处理

```typescript
// main.ts
import { createApp } from 'vue'
import App from './App.vue'
import router from './router'
import pinia from './store'

const app = createApp(App)

// 全局错误处理
app.config.errorHandler = (err, vm, info) => {
  console.error('Global error:', err, info)
  // 发送到错误监控服务
  // errorReportingService.captureException(err)
}

// 未处理的Promise错误
window.addEventListener('unhandledrejection', (event) => {
  console.error('Unhandled promise rejection:', event.reason)
  // errorReportingService.captureException(event.reason)
})

app.use(pinia)
app.use(router)
app.mount('#app')
```

#### 10.7.2 API错误处理

```typescript
// api/client.ts
this.client.interceptors.response.use(
  (response) => response.data,
  (error: AxiosError) => {
    const status = error.response?.status
    const message = error.response?.data?.message || '请求失败'

    switch (status) {
      case 400:
        ElMessage.error(`请求参数错误: ${message}`)
        break
      case 401:
        ElMessage.error('未认证，请重新登录')
        // 跳转到登录页
        break
      case 403:
        ElMessage.error('没有权限执行此操作')
        break
      case 404:
        ElMessage.error('请求的资源不存在')
        break
      case 500:
        ElMessage.error('服务器内部错误')
        break
      default:
        ElMessage.error(message)
    }

    return Promise.reject(error)
  }
)
```

---

## 11. 验收标准

### 11.1 功能验收

#### 11.1.1 用户认证模块
- [ ] 用户可以使用邮箱和密码登录
- [ ] 登录成功后正确获取用户权限和组权限
- [ ] 未登录用户访问受保护页面时自动跳转到登录页
- [ ] 用户可以正常登出
- [ ] Token过期时自动提示重新登录
- [ ] 用户可以修改个人信息
- [ ] 用户可以修改密码

#### 11.1.2 任务管理模块
- [ ] 用户可以创建新任务
- [ ] 用户可以查看自己的所有任务
- [ ] 用户可以编辑任务进展
- [ ] 进展更新后实时同步到其他用户
- [ ] 用户可以筛选和排序任务列表
- [ ] 组长可以编辑任务详情（描述、截止时间、责任人等）
- [ ] 组长可以删除任务
- [ ] 任务状态变更后列表自动更新

#### 11.1.3 团队管理模块
- [ ] 可以查看所有组的概览信息
- [ ] 点击组卡片可以进入组详情页
- [ ] 组详情页显示所有成员及其任务
- [ ] 组长可以添加/移除组员
- [ ] 组长可以设置组员角色
- [ ] 管理员可以查看所有组数据

#### 11.1.4 实时同步功能
- [ ] 任务进展更新后其他用户界面秒级更新
- [ ] 新任务创建后其他用户界面实时显示
- [ ] 任务删除后其他用户界面实时移除
- [ ] WebSocket断线后自动重连
- [ ] 重连成功后数据自动同步
- [ ] 离线时有明确提示

#### 11.1.5 数据统计模块
- [ ] 仪表板正确显示各项统计数据
- [ ] 图表数据准确无误
- [ ] 可以按时间范围筛选数据
- [ ] 可以按组别筛选数据
- [ ] 统计图表支持交互（悬停、点击等）
- [ ] 可以导出报表数据
- [ ] 移动端图表正常显示

#### 11.1.6 响应式设计
- [ ] 桌面端（≥1200px）三栏布局正常
- [ ] 平板端（768-1199px）两栏布局正常
- [ ] 移动端（<768px）单栏布局正常
- [ ] 移动端可以正常浏览和操作
- [ ] 不同屏幕尺寸下界面不溢出
- [ ] 文字大小在不同设备上清晰可读

### 11.2 性能验收

#### 11.2.1 加载性能
- [ ] 首屏加载时间 < 3秒
- [ ] 路由切换时间 < 500ms
- [ ] 任务列表加载时间 < 1秒
- [ ] 图表渲染时间 < 1秒

#### 11.2.2 运行性能
- [ ] 页面滚动流畅（60fps）
- [ ] 长时间使用无内存泄漏
- [ ] WebSocket连接稳定（24小时不断线）
- [ ] 虚拟滚动列表流畅滚动

#### 11.2.3 网络性能
- [ ] WebSocket消息延迟 < 2秒
- [ ] API请求响应时间 < 1秒
- [ ] 图片懒加载正常工作
- [ ] 资源压缩和缓存策略生效

### 11.3 兼容性验收

#### 11.3.1 浏览器兼容性
- [ ] Chrome 90+ 正常运行
- [ ] Firefox 88+ 正常运行
- [ ] Safari 14+ 正常运行
- [ ] Edge 90+ 正常运行

#### 11.3.2 设备兼容性
- [ ] Windows桌面端正常
- [ ] macOS桌面端正常
- [ ] iPad平板端正常
- [ ] iPhone手机端正常
- [ ] Android手机端正常

### 11.4 安全性验收

#### 11.4.1 前端安全
- [ ] 用户输入经过XSS防护
- [ ] 敏感信息不在URL中暴露
- [ ] Token安全存储在localStorage
- [ ] 权限验证正确（前端路由守卫）
- [ ] 不存在明显的安全漏洞

#### 11.4.2 数据安全
- [ ] 用户只能访问有权限的数据
- [ ] 组间数据相互隔离
- [ ] 个人信息脱敏处理
- [ ] 操作日志正确记录

### 11.5 用户体验验收

#### 11.5.1 界面体验
- [ ] 界面美观，符合设计规范
- [ ] 颜色搭配协调，视觉效果好
- [ ] 图标清晰易懂
- [ ] 文字大小适中，易于阅读

#### 11.5.2 交互体验
- [ ] 操作直观，学习成本低
- [ ] 反馈及时，操作有响应
- [ ] 错误提示友好明确
- [ ] 加载状态有明确指示
- [ ] 空状态有引导信息

#### 11.5.3 快捷操作
- [ ] 键盘快捷键正常工作
- [ ] 拖拽操作流畅
- [ ] 右键菜单功能正常
- [ ] 双击编辑功能正常

### 11.6 可维护性验收

#### 11.6.1 代码质量
- [ ] TypeScript类型检查通过
- [ ] ESLint无严重警告
- [ ] 代码注释完整清晰
- [ ] 组件划分合理，职责单一

#### 11.6.2 测试覆盖率
- [ ] 单元测试覆盖率 ≥ 80%
- [ ] 关键业务逻辑有测试覆盖
- [ ] 组件测试覆盖主要交互
- [ ] E2E测试覆盖核心流程

#### 11.6.3 文档完整性
- [ ] API文档完整
- [ ] 组件文档清晰
- [ ] 部署文档可执行
- [ ] 开发文档详细

---

## 📌 总结

本文档详细描述了团队任务追踪系统前端的所有功能需求、技术实现规范和验收标准。

**核心特性**:
- ✅ 完整的任务生命周期管理
- ✅ 多组协作和权限控制
- ✅ 秒级实时同步
- ✅ 丰富的数据统计和可视化
- ✅ 响应式设计，支持多设备

**技术亮点**:
- WebSocket实时通信
- 虚拟滚动长列表优化
- 组件化架构，易于维护
- TypeScript类型安全
- 完善的错误处理机制

**下一步行动**:
1. 确认需求文档完整性
2. 设计UI原型图和交互稿
3. 制定开发计划（MVP → 完整版）
4. 搭建开发环境和CI/CD流程
5. 开始编码实现

---

## 12. UI变更日志

### 12.1 版本历史

| 版本 | 日期 | 更新内容 | 负责人 |
|------|------|---------|--------|
| v2.0 | 2025-12-16 | 重大UI优化和功能增强 | 前端开发团队 |
| v1.0 | 2025-12-16 | 初始版本创建 | 项目团队 |

### 12.2 v2.0 重大更新详情

#### 12.2.1 品牌升级
- **服务名称更新**: 系统名称由通用名称更新为"KuaFu"
- **位置**: Logo文字、页面标题、通知栏显示

#### 12.2.2 仪表盘布局优化

**变更前**:
- 统计卡片采用自适应布局（auto-fit, minmax(280px, 1fr)）
- 在宽屏上可能显示为2+2布局
- 统计卡片之间缺乏固定对齐

**变更后**:
- 固定4列网格布局：`grid-template-columns: repeat(4, 1fr)`
- 确保总任务、已完成、进行中、闭环率4个卡片始终在一排展示
- 添加响应式支持：
  - 1280px以下：保持4列，缩小间距
  - 1024px以下：调整为2列
  - 640px以下：调整为1列
- **CSS文件**: `styles.css:523-548`

#### 12.2.3 团队概览页面重构

**变更前**:
- 所有团队共用一个大型图表
- 信息展示不够直观
- 各团队任务状态分布不清晰

**变更后**:
- 每个团队配备独立的环形小图表（直径120px）
- 使用65%空白切割的环形图设计
- 4个团队分别显示：
  - 前端组：已完成12，进行中9，待办2
  - 后端组：已完成8，进行中8，待办2
  - 测试组：已完成9，进行中4，待办2
  - 运维组：已完成7，进行中3，待办2
- 新增布局类：
  - `.teams-detailed-grid`: 420px最小宽度网格
  - `.team-detailed-card`: 团队详细卡片容器
  - `.team-chart-section`: 图表展示区域
- **HTML文件**: `index.html:140-276`
- **CSS文件**: `styles.css:702-771`
- **JavaScript文件**: `script.js:270-419`

#### 12.2.4 仪表盘与数据统计合并

**变更前**:
- 仪表板和数据统计为独立页面
- 需要频繁切换页面查看数据
- 整体数据查看效率低

**变更后**:
- 将仪表板、数据统计、闭环率趋势、各组任务对比合并为单一页面
- 统一入口：`/dashboard`路径
- 页面结构优化：
  - 顶部：4个统计卡片（一排展示）
  - 中部：团队概览（每个团队带小图表）
  - 底部：整体数据趋势（闭环率趋势、各组任务对比、任务完成时间分析）
- **HTML文件**: `index.html:78-319`

#### 12.2.5 团队概览与闭环率趋势间隔

**变更前**:
- 团队概览和整体数据趋势之间没有明确间隔
- 视觉层次不够清晰
- 页面内容粘在一起

**变更后**:
- 在`.charts-grid`上增加`margin-top: var(--space-8)`（32px）
- 两个部分之间有清晰的视觉分割
- **CSS文件**: `styles.css:1332-1337`

#### 12.2.6 各组任务对比图配色优化

**变更前**:
- 总任务：`rgba(0, 212, 255, 0.3)`（浅蓝色）
- 已完成：`rgba(0, 255, 136, 0.3)`（浅绿色）
- 对比性较弱，难以区分

**变更后**:
- 总任务：`rgba(79, 70, 229, 0.85)`（深紫色）→ 边框`#4338ca`
- 已完成：`rgba(245, 158, 11, 0.85)`（深橙色）→ 边框`#d97706`
- 对比性提升85%，使用互补色增强视觉区分度
- 圆角设计：`borderRadius: 6`
- 字体优化：从Rajdhani改为Inter，提升可读性
- tooltip优化：
  - 背景：`rgba(15, 23, 42, 0.95)`
  - 边框：`#4338ca`
  - 圆角：`8px`
- **JavaScript文件**: `script.js:112-193`

#### 12.2.7 我的任务页面重大重构

**核心变更**: 支持按创建日期筛选任务

**新增功能**:
1. **日期选择器**:
   - 位置：任务筛选按钮下方
   - 选项：今天(12-16)、昨天(12-15)、12-14、12-13、全部
   - 样式：等宽字体(Courier New)，清晰易读
   - 交互：点击切换显示对应日期的任务

2. **按日期分组显示**:
   - 每个日期独立分组（`.tasks-by-date`）
   - 日期分组标题带左侧紫色标记（4px）
   - 背景：浅灰色背景突出显示
   - 间距：组间有充足间距（32px）

3. **进度时间轴优化**:
   - 改进：修复任务名称左侧黑点和竖条重叠问题
   - 新增：`margin-left: -var(--space-2)`调整间距
   - 视觉效果：时间轴更清晰，日期、标题、描述分层展示

**文件变更**:
- **HTML文件**: `index.html:321-467`
  - 新增`.date-selector`容器
  - 新增`.tasks-by-date`分组容器
  - 新增`.date-group-title`日期标题
- **CSS文件**: `styles.css:967-1021`
  - 新增`.date-selector`样式
  - 新增`.date-btn`样式
  - 新增`.tasks-by-date`样式
  - 新增`.date-group-title`样式
  - 修复`.task-priority`重叠问题：`styles.css:975`
- **JavaScript文件**: `script.js:516-547`
  - 新增`initDateFilter()`函数
  - 支持日期筛选逻辑
  - 与现有筛选系统集成

#### 12.2.8 移除功能

**移除成员贡献排行**:
- 位置：原仪表盘底部
- 原因：简化界面，聚焦核心功能
- 影响：减少页面复杂度，提升加载速度

#### 12.2.9 设计系统升级

**v3.0企业级设计标准**:
- 8px网格系统
- 10级色彩系统（每个颜色50-700共9个层级）
- 5级阴影系统（xs到2xl）
- 5级圆角系统
- 3级动画系统（快速/标准/慢速）
- 2级缓动函数（标准/强调）
- WCAG 2.1无障碍标准支持

### 12.3 文件结构

**项目结构**:
```
frontend/                          # Vue3前端项目
├── public/
│   └── demo/                      # UI原型文件
│       ├── index.html            # 主页面结构
│       ├── styles.css            # 企业级样式文件（1477行→约1550行）
│       ├── script.js             # JavaScript功能文件
│       └── README.md             # 原型说明文档
├── src/                          # Vue源代码
└── ...
```

### 12.4 技术指标

| 指标 | v1.0 | v2.0 | 提升 |
|------|------|------|------|
| CSS代码行数 | 1477 | ~1550 | +73 |
| 颜色系统 | 7级 | 10级 | +43% |
| 功能模块 | 4个 | 5个 | +25% |
| 图表数量 | 3个 | 7个 | +133% |
| 任务筛选方式 | 状态筛选 | 状态+日期筛选 | +100% |
| 响应式断点 | 4个 | 5个 | +25% |

### 12.5 下一步计划

#### 短期目标（1-2周）
1. 将静态原型转换为Vue3组件
2. 实现状态管理（Pinia）
3. 集成Element Plus UI组件
4. 添加单元测试覆盖

#### 中期目标（2-4周）
1. 接入WebSocket实时通信
2. 实现后端API集成
3. 添加用户认证和权限控制
4. 性能优化和测试

#### 长期目标（1-2月）
1. 移动端适配优化
2. PWA支持
3. 多语言国际化
4. 数据导出功能

### 12.6 验收标准更新

#### 12.6.1 UI验收标准
- ✅ 仪表盘4个统计卡片始终在一排展示（≥1280px）
- ✅ 团队概览每个团队显示独立任务状态图表
- ✅ 我的任务支持按日期筛选和分组显示
- ✅ 各组任务对比图配色对比性 ≥ 85%
- ✅ 团队概览与数据趋势间有明确间隔（≥32px）
- ✅ 所有时间轴显示清晰，无重叠问题

#### 12.6.2 兼容性验收
- ✅ Chrome 90+ 完全兼容
- ✅ Firefox 88+ 完全兼容
- ✅ Safari 14+ 完全兼容
- ✅ Edge 90+ 完全兼容
- ✅ 1280px+ 保持4列统计卡片
- ✅ 1024px-1280px 保持4列统计卡片（缩小间距）
- ✅ 640px-1024px 调整为2列
- ✅ <640px 调整为1列

---

> 本文档为"阶段二：前端需求描述"的完整规范，为后续开发提供详细指导。
> **v2.0更新**: 本次更新记录了所有UI优化和功能增强，确保开发团队了解最新设计规范。

> 如有疑问或需要调整，请及时沟通确认。
